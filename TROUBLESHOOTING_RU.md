# Устранение неполадок с отображением панорам

Если панорама отображается черным экраном, следуйте этой инструкции для диагностики проблемы.

## 1. Проверка запуска бэкенда

Убедитесь, что бэкенд сервер запущен:

1. Откройте терминал в корневой папке проекта
2. Перейдите в папку backend: `cd backend`
3. Запустите сервер: `python app.py`
4. Сервер должен быть доступен по адресу: http://localhost:5000

## 2. Проверка доступности API

Откройте браузер и перейдите по адресу:
- http://localhost:5000/api/panoramas - должен вернуть список панорам
- http://localhost:5000/api/panoramas/1 - должен вернуть информацию о панораме с ID 1

## 3. Проверка WebGL поддержки

Откройте консоль браузера (F12) и выполните скрипт из файла `check_webgl.js`:

```javascript
// Проверка WebGL поддержки
(function() {
    const canvas = document.createElement('canvas');
    const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
    
    if (gl) {
        console.log('WebGL поддерживается');
        console.log('Максимальный размер текстуры:', gl.getParameter(gl.MAX_TEXTURE_SIZE));
    } else {
        console.log('WebGL НЕ поддерживается');
    }
})();
```

## 4. Проверка сетевых запросов

В консоли браузера перейдите на вкладку Network и обновите страницу панорамы:

1. Найдите запрос к `/api/panoramas/{id}` - должен вернуть 200 OK
2. Найдите запрос к `/api/panoramas/{id}/image` - должен вернуть 200 OK и изображение

## 5. Проверка CORS

Убедитесь, что в файле `backend/config.py` правильно настроены CORS:

```python
CORS(app, 
     origins=['http://localhost:3000', 'http://127.0.0.1:3000'],
     methods=['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS'],
     allow_headers=['Content-Type', 'Authorization'],
     supports_credentials=True)
```

## 6. Проверка существования файла

Убедитесь, что файл панорамы существует по пути, указанному в базе данных:

1. Откройте базу данных (SQLite файл `panorama_site.db`)
2. Найдите запись панорамы и проверьте поле `file_path`
3. Убедитесь, что файл существует по этому пути

## 7. Отладка с помощью тестовой страницы

Откройте страницу `/debug/panorama` в вашем приложении:

1. Укажите правильный ID панорамы
2. Следите за статусом в левом верхнем углу
3. Проверяйте консоль браузера на наличие ошибок

## 8. Распространенные ошибки

### Ошибка "CORS policy"
Решение: Проверьте настройки CORS в `backend/config.py`

### Ошибка "404 Not Found" для изображения
Решение: Проверьте, существует ли файл по указанному пути

### Ошибка "WebGL not supported"
Решение: Обновите браузер или используйте другой браузер с поддержкой WebGL

### Черный экран без ошибок
Решение: 
1. Проверьте, правильно ли загружается текстура
2. Убедитесь, что размер изображения не превышает максимальный размер текстуры WebGL
3. Проверьте консоль на наличие ошибок шейдеров

## 9. Логирование

Для получения дополнительной информации включите логирование:

1. В браузере откройте консоль (F12)
2. Проверьте сообщения об ошибках
3. В бэкенде проверьте логи сервера

Если проблема не решена, создайте issue с подробным описанием:
- Версия браузера
- Операционная система
- Скриншоты ошибок из консоли
- Информация о панораме (размеры, формат файла)