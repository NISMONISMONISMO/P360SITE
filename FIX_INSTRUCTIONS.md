# Исправление проблемы черного экрана панорам

## Диагностика проблемы

Основная причина черного экрана - это проблемы с подключением к API бэкенда. Ваши диагностические инструменты показали:

1. **API Connection Issues**: Все API тесты завершаются с ошибкой "Failed to fetch"
2. **Three.js работает**: Сам Three.js движок функционирует правильно
3. **Проблема с сетью**: Ошибка загрузки изображений панорам

## Решения

### 1. Запуск серверов

Используйте новый файл запуска:

```
start_servers.bat
```

Этот файл автоматически:
- Проверяет и устанавливает зависимости
- Запускает бэкенд на порту 5000
- Запускает фронтенд на порту 3000
- Предоставляет ссылки для диагностики

### 2. Проверка подключения

После запуска серверов откройте:
- Фронтенд: http://localhost:3000
- Бэкенд: http://localhost:5000
- Диагностика: http://localhost:3000/api_test_tool.html

### 3. Диагностика API

Откройте http://localhost:3000/api_test_tool.html и выполните все тесты:

1. **Проверка базового подключения** - должен показать "Подключение успешно!"
2. **Проверка списка панорам** - должен показать количество панорам
3. **Тест загрузки конкретной панорамы** - должен успешно загрузить изображение

### 4. Возможные проблемы и решения

#### Проблема: "Failed to fetch"
**Решение:**
- Убедитесь, что бэкенд запущен на порту 5000
- Проверьте, что в консоли бэкенда нет ошибок
- Убедитесь, что в браузере нет ошибок CORS

#### Проблема: CORS ошибки
**Решение:**
- Настройки CORS уже обновлены в `backend/config.py`
- Убедитесь, что изменения сохранены

#### Проблема: Панорамы не отображаются
**Решение:**
1. Проверьте, что в базе данных есть панорамы
2. Убедитесь, что файлы панорам существуют в папке uploads
3. Проверьте права доступа к файлам

### 5. Дополнительная диагностика

#### Тест загрузки изображений
Откройте http://localhost:3000/test_image_loading.html для проверки загрузки изображений.

#### Проверка консоли браузера
Откройте инструменты разработчика (F12) и проверьте:
- Вкладку Network на наличие ошибок 404, 500
- Вкладку Console на наличие ошибок JavaScript

### 6. Проверка базы данных

Если панорамы не отображаются:
1. Убедитесь, что файл `panorama_site.db` существует в папке backend
2. Проверьте, что в таблице panoramas есть записи
3. Убедитесь, что панорамы публичны (is_public = 1)

### 7. Создание тестовой панорамы

Если в базе нет панорам:
1. Зарегистрируйтесь в приложении
2. Авторизуйтесь как admin / 209030Tes!
3. Загрузите тестовую панораму через интерфейс

## Дополнительные инструменты

### API Test Tool
Файл: `api_test_tool.html`
Назначение: Комплексная диагностика подключения к API

### Image Loading Test
Файл: `test_image_loading.html`
Назначение: Проверка загрузки изображений панорам

### Batch файл запуска
Файл: `start_servers.bat`
Назначение: Автоматический запуск всех серверов

## Если проблема сохраняется

1. **Проверьте логи бэкенда** на наличие ошибок
2. **Убедитесь, что порты 3000 и 5000 свободны**
3. **Проверьте настройки брандмауэра**
4. **Очистите кэш браузера**

## Контактная информация

Если проблема не решена, предоставьте:
1. Скриншоты консоли браузера
2. Логи бэкенда
3. Результаты диагностики из api_test_tool.html